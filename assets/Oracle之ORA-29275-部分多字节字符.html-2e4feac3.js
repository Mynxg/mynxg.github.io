import{_ as t}from"./plugin-vue_export-helper-c27b6911.js";import{r as l,o,c as r,b as e,d as n,a as s,f as c}from"./app-3b64d3fc.js";const p={},d=c(`<p>背景：<br> 在Oracle数据库中，通过查询 A表所有数据，发现某个字段出现字符问题</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>SELECT * FROM  A
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="一、遇到的问题" tabindex="-1"><a class="header-anchor" href="#一、遇到的问题" aria-hidden="true">#</a> 一、遇到的问题</h2><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>ORA-29275: 部分多字节字符
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>排查过程：</p><p>1.先定位到哪条数据有问题，这可以通过二分查找方式缩小查询范围</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> <span class="token operator">*</span> <span class="token keyword">FROM</span> A  <span class="token keyword">WHERE</span> rownum <span class="token operator">&lt;</span> <span class="token number">12</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>2.拿出A所有的字段，进行查询，同样通过二分查找的方式缩小查询范围</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> q<span class="token punctuation">,</span>w<span class="token punctuation">,</span>e<span class="token punctuation">,</span>r<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token keyword">from</span> A
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>3.最终定位到 A表中的 w字段有问题</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span> w <span class="token keyword">from</span> A
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>显示如下错误：ORA-29275: 部分多字节字符</p><p>原因分析：</p><blockquote><p>可能某个字段中有半个中文字符则会报这个异常，原因为Oracle编码问题。</p></blockquote><h2 id="二、解决方法" tabindex="-1"><a class="header-anchor" href="#二、解决方法" aria-hidden="true">#</a> 二、解决方法：</h2><p>方法1：<br> 在有问题的字段上面加上 to_nchar(字段)</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">select</span>  TO_NCHAR<span class="token punctuation">(</span>w<span class="token punctuation">)</span> <span class="token keyword">from</span> A
<span class="token comment">-- 或者</span>
<span class="token keyword">select</span> TO_SINGLE_BYTE<span class="token punctuation">(</span>w<span class="token punctuation">)</span> <span class="token keyword">from</span>  A	
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>方法2：</p><blockquote><p>改数据库字符集</p><p>检查他们Oracle的nls_lang环境变量，发现他们客户端的nls_lang设置为 american.</p><p>改成export NLS_LANG=AMERICAN_AMERICA.ZHS16CGB231280后， 就正常了。</p></blockquote><p>方法3：</p><blockquote><p>在oracle中字段中找出汉字的方法：可以利用length(testname)和lengthb(testname)，其中length(testname)不论数字或者字符都算一个，</p><p>而lengthb则不同，比如说testname的值为：54看法12，用length(testname)的值为6，而lengthb(testname)的值为：8。</p><p>利用这个就可以非常清楚的判断一个字符中是否包含汉字了(字母除外)。<br> to_single_byte(c)转换成半角</p><p>to_multi_byte(c)转换成全角</p></blockquote><h2 id="三、附件" tabindex="-1"><a class="header-anchor" href="#三、附件" aria-hidden="true">#</a> 三、附件</h2>`,22),i=e("br",null,null,-1),u={href:"https://blog.csdn.net/zhangzhongzhong/article/details/78722105",target:"_blank",rel:"noopener noreferrer"},m={href:"https://blog.csdn.net/keueng/article/details/48808085",target:"_blank",rel:"noopener noreferrer"},h={href:"https://www.cnblogs.com/huaji666/p/8489592.html",target:"_blank",rel:"noopener noreferrer"},k={href:"https://blog.csdn.net/blood_Z/article/details/123524415",target:"_blank",rel:"noopener noreferrer"};function _(b,g){const a=l("ExternalLinkIcon");return o(),r("div",null,[d,e("p",null,[n("参考："),i,e("a",u,[n("ORA-29275部分多字节字符处理"),s(a)])]),e("p",null,[e("a",m,[n("ORA-29275:部分多字节字符"),s(a)])]),e("p",null,[e("a",h,[n(" Oracle数据库报错: ORA-29275:部分多字节字符"),s(a)])]),e("p",null,[e("a",k,[n("Oracle分页查询"),s(a)])])])}const x=t(p,[["render",_],["__file","Oracle之ORA-29275-部分多字节字符.html.vue"]]);export{x as default};
